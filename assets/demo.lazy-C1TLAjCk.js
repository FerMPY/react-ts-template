var ue=t=>{throw TypeError(t)};var J=(t,e,s)=>e.has(t)||ue("Cannot "+s);var r=(t,e,s)=>(J(t,e,"read from private field"),s?s.call(t):e.get(t)),f=(t,e,s)=>e.has(t)?ue("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),l=(t,e,s,i)=>(J(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s),d=(t,e,s)=>(J(t,e,"access private method"),s);import{S as Se,p as de,r as E,s as X,a as K,n as Oe,i as Y,b as fe,t as Ee,f as Qe,c as we,d as pe,e as Re,g as w,u as Te,h as Ie,j as je,k as De,l as S,L as Fe}from"./index-F3jKvX1p.js";var v,n,V,g,j,L,T,O,W,M,P,D,F,I,k,o,z,Z,ee,te,se,re,ie,ae,xe,ve,_e=(ve=class extends Se{constructor(e,s){super();f(this,o);f(this,v);f(this,n);f(this,V);f(this,g);f(this,j);f(this,L);f(this,T);f(this,O);f(this,W);f(this,M);f(this,P);f(this,D);f(this,F);f(this,I);f(this,k,new Set);this.options=s,l(this,v,e),l(this,O,null),l(this,T,de()),this.options.experimental_prefetchInRender||r(this,T).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,n).addObserver(this),be(r(this,n),this.options)?d(this,o,z).call(this):this.updateResult(),d(this,o,se).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ne(r(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ne(r(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,o,re).call(this),d(this,o,ie).call(this),r(this,n).removeObserver(this)}setOptions(e,s){const i=this.options,u=r(this,n);if(this.options=r(this,v).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof E(this.options.enabled,r(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");d(this,o,ae).call(this),r(this,n).setOptions(this.options),i._defaulted&&!X(this.options,i)&&r(this,v).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,n),observer:this});const h=this.hasListeners();h&&me(r(this,n),u,this.options,i)&&d(this,o,z).call(this),this.updateResult(s),h&&(r(this,n)!==u||E(this.options.enabled,r(this,n))!==E(i.enabled,r(this,n))||K(this.options.staleTime,r(this,n))!==K(i.staleTime,r(this,n)))&&d(this,o,Z).call(this);const a=d(this,o,ee).call(this);h&&(r(this,n)!==u||E(this.options.enabled,r(this,n))!==E(i.enabled,r(this,n))||a!==r(this,I))&&d(this,o,te).call(this,a)}getOptimisticResult(e){const s=r(this,v).getQueryCache().build(r(this,v),e),i=this.createResult(s,e);return Le(this,i)&&(l(this,g,i),l(this,L,this.options),l(this,j,r(this,n).state)),i}getCurrentResult(){return r(this,g)}trackResult(e,s){const i={};return Object.keys(e).forEach(u=>{Object.defineProperty(i,u,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(u),s==null||s(u),e[u])})}),i}trackProp(e){r(this,k).add(e)}getCurrentQuery(){return r(this,n)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=r(this,v).defaultQueryOptions(e),i=r(this,v).getQueryCache().build(r(this,v),s);return i.fetch().then(()=>this.createResult(i,s))}fetch(e){return d(this,o,z).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,g)))}createResult(e,s){var le;const i=r(this,n),u=this.options,h=r(this,g),a=r(this,j),y=r(this,L),x=e!==i?e.state:r(this,V),{state:Q}=e;let c={...Q},N=!1,b;if(s._optimisticResults){const m=this.hasListeners(),_=!m&&be(e,s),U=m&&me(e,i,s,u);(_||U)&&(c={...c,...we(Q.data,e.options)}),s._optimisticResults==="isRestoring"&&(c.fetchStatus="idle")}let{error:B,errorUpdatedAt:H,status:R}=c;if(s.select&&c.data!==void 0)if(h&&c.data===(a==null?void 0:a.data)&&s.select===r(this,W))b=r(this,M);else try{l(this,W,s.select),b=s.select(c.data),b=pe(h==null?void 0:h.data,b,s),l(this,M,b),l(this,O,null)}catch(m){l(this,O,m)}else b=c.data;if(s.placeholderData!==void 0&&b===void 0&&R==="pending"){let m;if(h!=null&&h.isPlaceholderData&&s.placeholderData===(y==null?void 0:y.placeholderData))m=h.data;else if(m=typeof s.placeholderData=="function"?s.placeholderData((le=r(this,P))==null?void 0:le.state.data,r(this,P)):s.placeholderData,s.select&&m!==void 0)try{m=s.select(m),l(this,O,null)}catch(_){l(this,O,_)}m!==void 0&&(R="success",b=pe(h==null?void 0:h.data,m,s),N=!0)}r(this,O)&&(B=r(this,O),b=r(this,M),H=Date.now(),R="error");const A=c.fetchStatus==="fetching",q=R==="pending",G=R==="error",he=q&&A,ce=b!==void 0,C={status:R,fetchStatus:c.fetchStatus,isPending:q,isSuccess:R==="success",isError:G,isInitialLoading:he,isLoading:he,data:b,dataUpdatedAt:c.dataUpdatedAt,error:B,errorUpdatedAt:H,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>x.dataUpdateCount||c.errorUpdateCount>x.errorUpdateCount,isFetching:A,isRefetching:A&&!q,isLoadingError:G&&!ce,isPaused:c.fetchStatus==="paused",isPlaceholderData:N,isRefetchError:G&&ce,isStale:oe(e,s),refetch:this.refetch,promise:r(this,T)};if(this.options.experimental_prefetchInRender){const m=$=>{C.status==="error"?$.reject(C.error):C.data!==void 0&&$.resolve(C.data)},_=()=>{const $=l(this,T,C.promise=de());m($)},U=r(this,T);switch(U.status){case"pending":e.queryHash===i.queryHash&&m(U);break;case"fulfilled":(C.status==="error"||C.data!==U.value)&&_();break;case"rejected":(C.status!=="error"||C.error!==U.reason)&&_();break}}return C}updateResult(e){const s=r(this,g),i=this.createResult(r(this,n),this.options);if(l(this,j,r(this,n).state),l(this,L,this.options),r(this,j).data!==void 0&&l(this,P,r(this,n)),X(i,s))return;l(this,g,i);const u={},h=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,y=typeof a=="function"?a():a;if(y==="all"||!y&&!r(this,k).size)return!0;const p=new Set(y??r(this,k));return this.options.throwOnError&&p.add("error"),Object.keys(r(this,g)).some(x=>{const Q=x;return r(this,g)[Q]!==s[Q]&&p.has(Q)})};(e==null?void 0:e.listeners)!==!1&&h()&&(u.listeners=!0),d(this,o,xe).call(this,{...u,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,o,se).call(this)}},v=new WeakMap,n=new WeakMap,V=new WeakMap,g=new WeakMap,j=new WeakMap,L=new WeakMap,T=new WeakMap,O=new WeakMap,W=new WeakMap,M=new WeakMap,P=new WeakMap,D=new WeakMap,F=new WeakMap,I=new WeakMap,k=new WeakMap,o=new WeakSet,z=function(e){d(this,o,ae).call(this);let s=r(this,n).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(Oe)),s},Z=function(){d(this,o,re).call(this);const e=K(this.options.staleTime,r(this,n));if(Y||r(this,g).isStale||!fe(e))return;const i=Ee(r(this,g).dataUpdatedAt,e)+1;l(this,D,setTimeout(()=>{r(this,g).isStale||this.updateResult()},i))},ee=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,n)):this.options.refetchInterval)??!1},te=function(e){d(this,o,ie).call(this),l(this,I,e),!(Y||E(this.options.enabled,r(this,n))===!1||!fe(r(this,I))||r(this,I)===0)&&l(this,F,setInterval(()=>{(this.options.refetchIntervalInBackground||Qe.isFocused())&&d(this,o,z).call(this)},r(this,I)))},se=function(){d(this,o,Z).call(this),d(this,o,te).call(this,d(this,o,ee).call(this))},re=function(){r(this,D)&&(clearTimeout(r(this,D)),l(this,D,void 0))},ie=function(){r(this,F)&&(clearInterval(r(this,F)),l(this,F,void 0))},ae=function(){const e=r(this,v).getQueryCache().build(r(this,v),this.options);if(e===r(this,n))return;const s=r(this,n);l(this,n,e),l(this,V,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},xe=function(e){Re.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(r(this,g))}),r(this,v).getQueryCache().notify({query:r(this,n),type:"observerResultsUpdated"})})},ve);function Ue(t,e){return E(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function be(t,e){return Ue(t,e)||t.state.data!==void 0&&ne(t,e,e.refetchOnMount)}function ne(t,e,s){if(E(e.enabled,t)!==!1){const i=typeof s=="function"?s(t):s;return i==="always"||i!==!1&&oe(t,e)}return!1}function me(t,e,s,i){return(t!==e||E(i.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&oe(t,s)}function oe(t,e){return E(e.enabled,t)!==!1&&t.isStaleByTime(K(e.staleTime,t))}function Le(t,e){return!X(t.getCurrentResult(),e)}var Ce=w.createContext(!1),Me=()=>w.useContext(Ce);Ce.Provider;function Pe(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var ke=w.createContext(Pe()),Ne=()=>w.useContext(ke);function Be(t,e){return typeof t=="function"?t(...e):!!t}function ge(){}var He=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Ae=t=>{w.useEffect(()=>{t.clearReset()},[t])},ze=({result:t,errorResetBoundary:e,throwOnError:s,query:i,suspense:u})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(u&&t.data===void 0||Be(s,[t.error,i])),Ve=(t,e)=>e.state.data===void 0,We=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...s)=>Math.max(e(...s),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},$e=(t,e)=>t.isLoading&&t.isFetching&&!e,Ke=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,ye=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function qe(t,e,s){var c,N,b,B,H;const i=Te(),u=Me(),h=Ne(),a=i.defaultQueryOptions(t);(N=(c=i.getDefaultOptions().queries)==null?void 0:c._experimental_beforeQuery)==null||N.call(c,a),a._optimisticResults=u?"isRestoring":"optimistic",We(a),He(a,h),Ae(h);const y=!i.getQueryCache().get(a.queryHash),[p]=w.useState(()=>new e(i,a)),x=p.getOptimisticResult(a),Q=!u&&t.subscribed!==!1;if(w.useSyncExternalStore(w.useCallback(R=>{const A=Q?p.subscribe(Re.batchCalls(R)):ge;return p.updateResult(),A},[p,Q]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),w.useEffect(()=>{p.setOptions(a,{listeners:!1})},[a,p]),Ke(a,x))throw ye(a,p,h);if(ze({result:x,errorResetBoundary:h,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw x.error;if((B=(b=i.getDefaultOptions().queries)==null?void 0:b._experimental_afterQuery)==null||B.call(b,a,x),a.experimental_prefetchInRender&&!Y&&$e(x,u)){const R=y?ye(a,p,h):(H=i.getQueryCache().get(a.queryHash))==null?void 0:H.promise;R==null||R.catch(ge).finally(()=>{p.updateResult()})}return a.notifyOnChangeProps?x:p.trackResult(x)}function Ge(t,e){return qe({...t,enabled:!0,suspense:!0,throwOnError:Ve,placeholderData:void 0},_e)}const tt=Ie("/demo")({component:Je});function Je(){const t=je.c(8),{data:e}=Ge(De);let s,i;t[0]===Symbol.for("react.memo_cache_sentinel")?(s=S.jsx("h1",{className:"mb-8 text-4xl font-extrabold text-blue-400",children:"TanStack Router & Query Demo"}),i=S.jsx("p",{className:"mb-4 text-lg text-gray-300",children:"This page demonstrates the power of TanStack Router and Query."}),t[0]=s,t[1]=i):(s=t[0],i=t[1]);let u,h;t[2]===Symbol.for("react.memo_cache_sentinel")?(u=S.jsx("div",{className:"mb-8",children:S.jsx(Fe,{to:"/",className:"rounded bg-blue-500 px-4 py-2 font-bold text-white hover:bg-blue-700",children:"Back to Home"})}),h=S.jsx("h2",{className:"mb-4 text-2xl font-bold text-blue-400",children:"Posts:"}),t[2]=u,t[3]=h):(u=t[2],h=t[3]);let a;t[4]!==e?(a=e==null?void 0:e.map(Xe),t[4]=e,t[5]=a):a=t[5];let y;return t[6]!==a?(y=S.jsxs("div",{className:"flex h-fit flex-col items-center justify-center bg-gray-900 text-white",children:[s,i,u,h,S.jsx("ul",{className:"grid grid-cols-1 gap-4 py-8 md:grid-cols-2 lg:grid-cols-3 lg:px-8 xl:grid-cols-4 xl:px-16 2xl:grid-cols-4 2xl:gap-8 2xl:px-36",children:a})]}),t[6]=a,t[7]=y):y=t[7],y}function Xe(t){return S.jsxs("li",{className:"mb-2 rounded-md bg-gray-800 p-4 shadow-md",children:[S.jsx("h3",{className:"text-xl font-semibold text-blue-300",children:t.title}),S.jsx("p",{className:"text-gray-300",children:t.body})]},t.id)}export{tt as Route};
